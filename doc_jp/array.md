[目次へ戻る](index.md)
## 配列

### 1次元配列

1次元配列は次のコードで配列を生成することができる。`i`は変数の型(他に`d`、`z`が指定可)、1は配列の次元、5が要素数、aが変数名になっている。上のコードでは「1次元で要素数が5の配列」を生成することができる。
```fsharp
ch.i1 5 <| fun a ->
```
以下のように、要素数が未定の配列を宣言し、後から要素数を指定しても良い。
```fsharp
ch.i01 <| fun a ->
    a.allocate(5)
    a.deallocate()
```
`allocate`関数の引数は要素数を表わし、必要なメモリを確保する関数。
`deallocate`は確保したメモリを解放する関数。
`deallocate`の後は要素数が0となり、再び`allocate`関数でメモリを確保するまで配列を使用できなくなる。

- 以下は配列の変数名を「a」とした場合の例
  - a.clear()で要素の値をすべて0に初期化する（配列以外の変数にも使用可能）
  - 配列の要素は角括弧で指定する。要素インデックスは1から始まる正の整数（整数型の変数でも良い）配列の範囲を超えたインデックスを指定するとエラーが出る（エラーが出ずに完全におかしな計算結果のまま処理が進行することもあるので注意）

```fsharp
ch.i 5 <| fun ->
    //配列aの先頭要素に5を代入
    a[1] <== 5
    //配列aの第2要素に10を代入
    a[2] <== 10
    //以下はエラー
    a[0] <== 10
    a[-1] <== 10
```
`a.size1`で配列の要素数を参照できる
```fsharp
//配列aの最終要素に10を代入
a[a.size1] <== 10
```

### 2次元配列

2次元配列は、同じ型の変数が縦横に2次元的に並んでいるイメージ。画像や面上の電界分布等を表わすのによく使われる
次のコードで2次元配列を生成できる。
```fsharp
ch.i2 3 5 <| fun a ->
```
全要素を0で初期化するときは`a.clear()`と記述する

配列の要素にアクセスするときは「`a[1,2]`」のように入力する。

配列aの第1インデックスの要素数は`a.size1`、第2インデックスの要素数は`a.size2`で参照できる。

### 3次元配列

次のコードで3次元配列を生成できる。
```fsharp
ch.i3 3 4 5 <| fun a ->
```

### 部分配列

3個の配列`x`,`y`,`z`に対して、以下の要素同士の四則演算、代入式
```fsharp
iter.num z.size1 <| fun i ->
    z[i] <== x[i] - y[i]
```
は次のように書ける（2、3次元配列も同様）
```fsharp
z <== x - y
```
全要素でなく、要素の範囲を指定することもできる。第1～3要素のみ演算する場合は、
```fsharp
z[(1,3)] <== x[(1,3)] - y[(1,3)]
```
とする。2次元配列の第4列の全要素を演算する場合は
```fsharp
z[(),4] <== x[(),4] - y[(),4]
```
とする。